# Buildroot defconfig for CDM minimal Linux x86_64 QEMU image
#
# Target: x86_64 QEMU -M pc, BusyBox initramfs, no libc headers on host.
# Packages: BusyBox, OpenSSL, curl, mosquitto (for mTLS MQTT test).
#
# Generate full .config: copy this file to buildroot-X.Y.Z/.config, then
# run `make olddefconfig` inside the Buildroot tree.

# Architecture
BR2_x86_64=y
BR2_x86_64_v2=y

# Toolchain
BR2_TOOLCHAIN_BUILDROOT_UCLIBC=y
BR2_KERNEL_HEADERS_6_6=y

# Kernel
BR2_LINUX_KERNEL=y
BR2_LINUX_KERNEL_USE_ARCH_DEFAULT_CONFIG=y
BR2_LINUX_KERNEL_COMPRESS_XZ=y

# Root filesystem: cpio.gz initramfs (loaded by QEMU -initrd)
BR2_TARGET_ROOTFS_CPIO=y
BR2_TARGET_ROOTFS_CPIO_GZIP=y
BR2_ROOTFS_OVERLAY="$(TOPDIR)/../overlay"

# System
BR2_SYSTEM_DHCP="eth0"
BR2_TARGET_GENERIC_HOSTNAME="cdm-qemu-device"
BR2_TARGET_GENERIC_ISSUE="CDM QEMU Device"

# Required packages
BR2_PACKAGE_BUSYBOX=y
BR2_PACKAGE_OPENSSL=y
BR2_PACKAGE_OPENSSL_BIN=y
BR2_PACKAGE_LIBCURL=y
BR2_PACKAGE_LIBCURL_OPENSSL=y
BR2_PACKAGE_CURL=y
BR2_PACKAGE_MOSQUITTO=y
BR2_PACKAGE_MOSQUITTO_CLIENT=y
BR2_PACKAGE_MOSQUITTO_OPENSSL=y

# Strip and optimize for size
BR2_STRIP_strip=y
BR2_OPTIMIZE_S=y
