# provider-stack/.env.example
#
# Copy to .env and fill in your secrets before starting the stack:
#   cp .env.example .env
#
# Items marked [CHANGE ME] MUST be replaced in any non-development deployment.
# All other values are safe defaults for local dev / Codespaces evaluation.

# ── External URL ─────────────────────────────────────────────────────────────
# Browser-facing base URL of this stack (port 8888).
# Local dev:     http://localhost:8888
# GitHub Codespaces: https://<codespace-name>-8888.app.github.dev
EXTERNAL_URL=https://fictional-train-4xw7jp4jg3754q-8888.app.github.dev

# External URL for InfluxDB proxy (direct port 8086, separate from Caddy).
# Local dev:     http://localhost:8086
# GitHub Codespaces: https://<codespace-name>-8086.app.github.dev
INFLUX_EXTERNAL_URL=https://fictional-train-4xw7jp4jg3754q-8086.app.github.dev

# ── Caddy ────────────────────────────────────────────────────────────────────
CADDY_PORT=8888
# Set to "on" to enable automatic HTTPS (needs a real domain / ACME challenge)
CADDY_AUTO_HTTPS=off

# ── Keycloak ─────────────────────────────────────────────────────────────────
KC_ADMIN_USER=admin
KC_ADMIN_PASSWORD=2068b5614e7a34e6c09f4af3ebe1b2b9
KC_DB_PASSWORD=c5adfbddabf325c0d587909be05f6a41

# OIDC client secrets – must match values baked into the realm templates.
# Run `openssl rand -hex 32` to generate a fresh secret.
GRAFANA_OIDC_SECRET=f5f64e6a141d60ba1355df01b99689eb
GRAFANA_BROKER_SECRET=f6d78b9db48856de27d0a980b98bbfce
BRIDGE_OIDC_SECRET=bae58c1ef2ecfea3ce4b5e8c82b48ddf
PORTAL_OIDC_SECRET=9caa92178c4fba2c98afd76ebc900fef
INFLUX_PROXY_OIDC_SECRET=b3c61e759149868afc0c9ae80686f62d

# Bootstrap user passwords for the provider realm
PROVIDER_OPERATOR_PASSWORD=1ef4d0183fa42494a187dac427f59b94

# ── RabbitMQ ─────────────────────────────────────────────────────────────────
RABBITMQ_ADMIN_USER=admin
RABBITMQ_ADMIN_PASSWORD=0d3df62621ca03742543e495acba6579
RABBITMQ_MANAGEMENT_OIDC_SECRET=428f4a7f5314f520087b9b9c8c434f871a4326106069efa306bd30280e79a3c0

# ── InfluxDB ─────────────────────────────────────────────────────────────────
INFLUX_ADMIN_USER=admin
INFLUX_ADMIN_PASSWORD=396a608412222887259e41a33cbb8cd81A
INFLUX_TOKEN=eeab9a7552ce9b8c4e4fbe5ac29147aed20f81cd364eba320537b1ca79653ebe

# Cookie secret for the oauth2-proxy in front of InfluxDB.
# Must be 16, 24, or 32 bytes (hex-encoded → 32, 48, or 64 hex chars).
# Generate: openssl rand -hex 32
INFLUX_PROXY_COOKIE_SECRET=xv7OYvb3lKFgHH7aKVRnKH3eM0CI4O9XQaEK4kb0xIg=
# Set to "true" when serving over HTTPS (e.g. GitHub Codespaces)
INFLUX_PROXY_COOKIE_SECURE=true
# Use "none" (with Secure=true) to allow cross-site redirects via OAuth2 flow
INFLUX_PROXY_COOKIE_SAMESITE=none

# ── Grafana ──────────────────────────────────────────────────────────────────
# No extra secrets needed – uses GRAFANA_OIDC_SECRET and INFLUX_TOKEN above.

# ── IoT Bridge API ───────────────────────────────────────────────────────────
PORTAL_SESSION_SECRET=1d3a8b97928f353d2f7f9761dba6dc8cc0b81f467a1b88b637c5d55af1450aa0

# JSON map of tenants exposed in the portal (provider-stack default: cdm only)
# Add tenant entries when tenant-stacks are onboarded, e.g.:
# '{"cdm":{"name":"CDM Platform"},"acme":{"name":"Acme Devices GmbH"}}'
PORTAL_TENANTS_JSON={"cdm":{"name":"CDM Platform"}}

# ── step-ca (PKI) ────────────────────────────────────────────────────────────
STEP_CA_PKI_NAME=CDM Root CA
STEP_CA_DNS_NAMES=step-ca,localhost
STEP_CA_ADDRESS=:9000
STEP_CA_ADMIN_PROVISIONER=cdm-admin@cdm.local
STEP_CA_ENABLE_ACME=true
STEP_CA_ENABLE_REMOTE_MGMT=true
STEP_CA_ENABLE_SSH=false

# Set by iot-bridge-api after step-ca starts (fingerprint of root CA cert).
# Run: docker exec provider-step-ca step ca fingerprint
STEP_CA_FINGERPRINT=5d49b58d0cd534061b543b299eab982e7015dc2b1c73c4546da7803b9716f496

# JWK provisioner used by iot-bridge-api to sign device certificates
STEP_CA_PROVISIONER_NAME=iot-bridge
STEP_CA_PROVISIONER_PASSWORD=9f7a76338be59382448b13699b6fdeb7
STEP_CA_ADMIN_PASSWORD=8d979ac9e28f24ff9bd6b98b23f297c7
STEP_CA_VERIFY_TLS=false
