# hawkBit Update Server – application.properties
# Mounted read-only into the container at /opt/hawkbit/application.properties

# ─── Server ───────────────────────────────────────────────────────────────────
server.port=8070

# ─── Database (MySQL) ────────────────────────────────────────────────────────
spring.datasource.url=jdbc:mysql://hawkbit-db:3306/hawkbit?useInformationSchema=true
spring.datasource.username=hawkbit
spring.datasource.password=${HB_DB_PASSWORD:?HB_DB_PASSWORD must be set}
spring.datasource.hikari.connection-timeout=30000
spring.jpa.hibernate.ddl-auto=update

# ─── Artifact Storage ─────────────────────────────────────────────────────────
org.eclipse.hawkbit.repository.file.path=/data/artifacts

# ─── Security – anonymous access disabled ────────────────────────────────────
hawkbit.server.security.anonymous.enabled=false

# ─── Security – DDI API token for device agents (rauc-hawkbit-updater) ───────
# Devices authenticate using a Target Security Token sent in the Authorization
# header. Tokens are generated per-target inside hawkBit.
hawkbit.server.security.dos.filter.enabled=true
hawkbit.server.security.dos.maxStatusEntriesPerAction=1000
hawkbit.server.security.dos.maxAttributeEntriesPerTarget=100
hawkbit.server.security.dos.maxActionsPerTarget=4000

# ─── Keycloak OIDC for the Management UI ─────────────────────────────────────
# hawkBit supports Spring Security OAuth2 out of the box.
spring.security.oauth2.client.registration.keycloak.client-id=hawkbit
spring.security.oauth2.client.registration.keycloak.client-secret=${HB_OIDC_SECRET:?HB_OIDC_SECRET must be set}
spring.security.oauth2.client.registration.keycloak.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.keycloak.scope=openid,profile,email
spring.security.oauth2.client.provider.keycloak.issuer-uri=http://keycloak:8080/auth/realms/cdm

# ─── Polling intervals ────────────────────────────────────────────────────────
hawkbit.controller.pollingTime=00:01:00
hawkbit.controller.minPollingTime=00:00:30

# ─── Logging ─────────────────────────────────────────────────────────────────
logging.level.org.eclipse.hawkbit=INFO
